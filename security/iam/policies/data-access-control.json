
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Effect": "Allow",
      "Action": [
        "dynamodb:GetItem",
        "dynamodb:Query"
      ],
      "Resource": ["arn:aws:dynamodb:*:*:table/PatientRecords"],
      "Condition": {
        "ForAllValues:StringEquals": {
          "dynamodb:LeadingKeys": ["${aws:PrincipalTag/department}"],
          "dynamodb:Attributes": [
            "PatientID",
            "NonSensitiveData"
          ]
        },
        "IpAddress": {"aws:SourceIp": ["10.0.0.0/16"]}
      }
    },
    {
      "Effect": "Deny",
      "Action": ["dynamodb:*"],
      "Resource": ["*"],
      "Condition": {"Bool": {"aws:SecureTransport": "false"}}
    }
  ]
}